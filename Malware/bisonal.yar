rule bisonal_decode_jsac
{
	strings:
      $decode =  { bb bf 58 00 00 8b fd 8d 0c 40 c1 e1 04 2b c8 8d 0c 49 8d 0c 89 8d 0c c9 8d 04 48 83 c9 ff  }
	condition:
	   uint16(0) == 0x5A4D and $decode
}


rule bisonal_old
{
   meta:
	    reference = "https://www.paloaltonetworks.jp/company/in-the-news/2018/unit42-bisonal-malware-used-attacks-russia-south-korea"
	strings:
            $s1 = "akspbu.txt" ascii wide
            $s2 = "ks8d" ascii wide
            $s3 = "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR 1.1.4322" ascii wide
	condition:
	   uint16(0) == 0x5A4D and all of ($s*)
}
