rule bisonal_decode
{
	strings:
	   $decode1 = {80 b4 35 00 fe ff ff 1d 8d 85 00 fe ff ff 50 46}
      $decode2 = {8b 48 14 69 c9 fd 43 03 00 81 c1 c3 9e 26 00 89 48 14 8b c1 c1 e8 10 25 ff 7f 00 00}
	condition:
	    all of ($decode*)
}

rule bisonal_old
{
   meta:
	    reference = "https://www.paloaltonetworks.jp/company/in-the-news/2018/unit42-bisonal-malware-used-attacks-russia-south-korea"
	strings:
            $s1 = "akspbu.txt" ascii wide
            $s2 = "ks8d" ascii wide
            $s3 = "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR 1.1.4322" ascii wide
	condition:
	    all of ($s*)
}

rule bisonal_strings
{
   meta:
      author = "str_yaragen"
      date = "2020-01-15"
      hash1 = "2a76dfa4d59fb7e22f4a60b8fa8f9bc67ebeba279bfad00c5f7f54bcb3dd75fc"
      hash2 = "fdc0deb4e2241b97121b6ccaf8564c9b996c45746974f2dee0cff8506a3960b0"
      hash3 = "571e2e176839effda3f236a942244ad37ba4ce987432cf4bd98cf82c94b98fd6"
      hash4 = "8f0debad0c201c309eaa64edfb924725d3a95735aab9f90fd6bd906f71718028"
   strings:
      $s0 = "WriteCmdPipe Error. Could not find cmd.exe(PID=%d)! ErrorCode=%d." ascii wide //10.06
      $s1 = "Cmd.exe is closed." ascii wide //9.40
      $s2 = "/post.asp" ascii wide //8.94
      $s3 = "HttpSendRequest error: %d ." ascii wide //8.91
      $s4 = "HttpOpenRequest error: %d ." ascii wide //8.91
      $s5 = "=InTernEtC0nect err0r: %d ." ascii wide //8.37
      $s6 = "ReCeiVe DAta Br0keN." ascii wide //5.19
      $s7 = "Software\\Microsoft\\Windows\\Cur" ascii wide //8.22
      $s8 = "InternetReadFile error: %d ." ascii wide //8.21
      $s9 = "1nternet0pen err0r: %d ." ascii wide //8.20
      $s10 = "Windows Server 2008/Vista" ascii wide //8.14
      $s11 = "Host: www.github" ascii wide //8.13
      $s12 = "Windows 7/Server 2008 R2" ascii wide //8.10
   condition:
      uint16(0) == 0x5A4D and 10 of them
}
